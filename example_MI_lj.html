

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mold integration for 100 plane of Lennard-Jones crystal &mdash; SurFEC  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Solid-Vacuum interface of a Lennard-Jones crystal with wells" href="example_LM_mw.html" />
    <link rel="prev" title="Examples" href="example.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> SurFEC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="lammps.html">LAMMPS commands</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="example.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mold integration for 100 plane of Lennard-Jones crystal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#optimal-radius-calculation">Optimal radius calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#thermodynamic-integration">Thermodynamic integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extrapolation-and-interfacial-energy-calculation">Extrapolation and interfacial energy calculation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="example_LM_mw.html">Solid-Vacuum interface of a Lennard-Jones crystal with wells</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SurFEC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="example.html">Examples</a> &raquo;</li>
        
      <li>Mold integration for 100 plane of Lennard-Jones crystal</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/example_MI_lj.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="mold-integration-for-100-plane-of-lennard-jones-crystal">
<h1>Mold integration for 100 plane of Lennard-Jones crystal<a class="headerlink" href="#mold-integration-for-100-plane-of-lennard-jones-crystal" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this section <code class="docutils literal notranslate"><span class="pre">/</span></code> is the package’s root folder.</p>
</div>
<p>Here we provide a detailed instructions to reproduce the crystal fluid interfacial free energy using the BG and <code class="docutils literal notranslate"><span class="pre">square/well</span> <span class="pre">pair_style</span></code> available in LAMMPS.</p>
<p>The data file (<code class="docutils literal notranslate"><span class="pre">mold_100.lmp</span></code>) and LAMMPS script (<code class="docutils literal notranslate"><span class="pre">lj_moldint.in</span></code>) is provided in the directory <code class="docutils literal notranslate"><span class="pre">/examples/lj_mold/</span></code>, but in this work example we will navigate through those files to explain them in detail.</p>
<p>The mold integration technique consists of different steps and here we only discuss the last two steps to obtain the interfacial energy of the 100 plane for the LJ particles at <span class="math notranslate nohighlight">\(T^\ast=0.617\)</span> and <span class="math notranslate nohighlight">\(p^\ast=-0.02\)</span>. All the steps can be found in Espinosa <em>et al.</em><a class="footnote-reference brackets" href="#footcite-espinosa2014mold" id="id1">1</a>, and they can be summarized as:</p>
<ol class="arabic simple">
<li><p>Preparation of the configuration by embedding the mold coordinates (from a crystal configuration) into the fluid at coexistence conditions.</p></li>
<li><p>Choice of the <a class="reference internal" href="#optimal-radius-calculation"><span class="std std-doc">optimal well radius</span></a> <span class="math notranslate nohighlight">\(r_{0w}\)</span> to extrapolate the interfacial energy.</p></li>
<li><p><a class="reference internal" href="#thermodynamic-integration"><span class="std std-doc">Thermodynamic integration</span></a> to calculate the interfacial energy for different well radii above the optimal radius
<span class="math notranslate nohighlight">\(\gamma(r_{0w}&gt;r_w)\)</span>.</p></li>
<li><p>Extrapolation of the interfacial energy to the optimal radius <span class="math notranslate nohighlight">\(r_{0w}\)</span>.</p></li>
</ol>
<p>The configuration (step 1) can be created easily using the liquid and crystal configuration at the corresponding <span class="math notranslate nohighlight">\((p,T)\)</span> conditions. In this example, we provide the system data file for the plane 100 of a LJ particles at <span class="math notranslate nohighlight">\(T^\ast=0.617\)</span> and <span class="math notranslate nohighlight">\(p^\ast=-0.02\)</span>:</p>
<p><img alt="Step-1" src="_images/Fig1.png" /></p>
<div class="section" id="optimal-radius-calculation">
<h2>Optimal radius calculation<a class="headerlink" href="#optimal-radius-calculation" title="Permalink to this headline">¶</a></h2>
<p>The calculation of the optimal radius for extrapolation of the interfacial energy includes the following steps:</p>
<ol class="arabic simple">
<li><p>Create a directory sweeping different radii (<span class="math notranslate nohighlight">\(r_w=0.27,\ 0.28,\ \ldots,0.33,0.34\sigma\)</span>).</p></li>
<li><p>For each radius one needs to run different independent velocity seeds. Create 10 directories for each radius directory.</p></li>
<li><p>Copy the LAMMPS script file (<code class="docutils literal notranslate"><span class="pre">lj_mold.in</span></code>) in each subdirectory along with the configuration file (<code class="docutils literal notranslate"><span class="pre">mold_100.lmp</span></code>).</p></li>
<li><p>The LAMMPS script contains several variables that it is important to know to properly perform the simulations:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># ---------------------------- Define variables --------------------------------
variable  nts          equal  400000     # production number of time-steps
variable  ts           equal  0.001      # length of the ts (in lj units)
variable  siglj        equal  1.0        # sigma coefficient for BG pair-style
variable  epslj        equal  1.0        # epsilon coefficient for BG pair-style
variable  cut1         equal  2.3        # internal cut-off for BG pair-style
variable  cut2         equal  2.5        # external cut-off for BG pair-style
variable  rw           equal  0.33       # (reduced) width of the square well potential
variable  alpha        equal  0.005      # exponent of the square well potential
variable  nkT          equal  8.0        # well depth (reduced units) 
variable  seed         equal  23782      # velocity seed
variable  Tsyst        equal  0.617      # (reduced) temperature of the system
variable  Psyst        equal  -0.02      # (reduced) press of the system
variable  NtsTdamp     equal  100        # Number of ts to damp temperature
variable  NtsPdamp     equal  100        # Number of ts to damp pressure
variable  thermoSteps  equal  1000       # Number of ts to write properties on screen
variable  restartSteps equal  30000      # Number of ts before write restart file
variable  dumpSteps    equal  5000       # Number of ts before write dump file

# --------------------- Derivate variables -------------------------------------
variable cutoff1     equal  ${siglj}*${cut1}
variable cutoff2     equal  ${siglj}*${cut2}
variable cutoff_well equal  ${rw}*4.0
variable D           equal  ${nkT}*${Tsyst} # Depth of well
variable Tdamp       equal  ${NtsTdamp}*${ts}
variable Pdamp       equal  ${NtsPdamp}*${ts}


####  Define mold  ####
read_data       mold_100.lmp
group melt type 1
group mold type 2

</pre></div>
</div>
<p>For this step, the typical run must be approximately 200000 time-steps (with dt=1e-3), and that can be controlled by the parameter <code class="docutils literal notranslate"><span class="pre">nts</span></code>.
Regarding the interaction potential, the parameter <code class="docutils literal notranslate"><span class="pre">rw</span></code> stands for the well radius so this must be changed for the different studies radii during this step <code class="docutils literal notranslate"><span class="pre">rw</span></code>=<span class="math notranslate nohighlight">\(0.27,\ 0.28,\ \ldots,0.33,0.34\sigma\)</span>.
The parameter <code class="docutils literal notranslate"><span class="pre">nkT</span></code> gives the well depth in <span class="math notranslate nohighlight">\(k_{B}T\)</span> units and for this step must be kept to 8 or bigger.
Regarding the velocity seed, the variable <code class="docutils literal notranslate"><span class="pre">seed</span></code> controls this aspect and thus, it must be changed with a random integer number for each simulation.
Also, there are some variables that might be interesting to know:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">thermoSteps</span></code> gives the number of timesteps to print the thermo</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">restartSteps</span></code> indicates the frequency of saving the restart files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dumpSteps</span></code> is the number of steps to save the trajectory in the dump file and for this step it is recommended to be set to 2000.</p></li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Launch the simulation for each radius and seed. That means a total of 80 simulations, but they are quite short.</p></li>
<li><p>The analysis of this step consists in determining if there is induction time, <em>i.e.</em> if that radius can be thermodynamically integrated. To do so, the resulting trajectory must be analyzed using the order parameter <span class="math notranslate nohighlight">\({\bar{q}}_6\)</span> to determine the number of particles on the cluster.
The recommended values for such analysis is a threshold of <span class="math notranslate nohighlight">\({\bar{q}}_6=0.34\)</span>, and a cutoff of <span class="math notranslate nohighlight">\(1.35\sigma\)</span>. As a result, one obtains different curves for the order parameter as a function of time for the different well radii:</p></li>
</ol>
<p><img alt="Step-1\label{kk}" src="_images/Fig2.png" /></p>
<p>A system can be considered to be integrated if the order parameter remains close to the total number of molds within the system (98 wells for this example). Therefore, in this case we can consider <span class="math notranslate nohighlight">\(r_w=0.32\sigma\)</span> as the greatest radius with not sufficiently long induction time so it is chosen as our optimal radius to extrapolate.</p>
</div>
<div class="section" id="thermodynamic-integration">
<h2>Thermodynamic integration<a class="headerlink" href="#thermodynamic-integration" title="Permalink to this headline">¶</a></h2>
<p>Once the optimal radius is estimated, the next step consists in thermodynamic integration of different radii above the optimal value of <span class="math notranslate nohighlight">\(r_w\)</span>. The calculation of the interfacial energy for the different well radii includes the following steps:</p>
<ol class="arabic simple">
<li><p>Create a directory for each radius to be integrated (<span class="math notranslate nohighlight">\(r_w=0.33,0.34,0.35\sigma\)</span>) and in each directory, create a for each well depth considered for the calculation. This is a truncated range of values of <span class="math notranslate nohighlight">\(\epsilon\)</span> in <span class="math notranslate nohighlight">\(k_{B}T\)</span>:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.00001</span>
<span class="mf">0.1</span>
<span class="mf">0.2</span>
<span class="o">...</span>
<span class="mf">1.9</span>
<span class="mf">2.0</span>
<span class="mf">2.3</span>
<span class="mf">2.6</span>
<span class="mi">3</span>
<span class="mf">3.5</span>
<span class="mi">4</span>
<span class="mf">4.5</span>
<span class="mi">5</span>
<span class="mi">6</span>
<span class="mi">7</span>
<span class="mi">8</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Copy the LAMMPS script file (<code class="docutils literal notranslate"><span class="pre">lj_mold.in</span></code>) in each subdirectory along with the configuration file (<code class="docutils literal notranslate"><span class="pre">mold_100.lmp</span></code>).</p></li>
<li><p>The variables of the LAMMPS script presented in previous section need to be changed slightly. For this step, the typical run must be of the order of hundred of thousands time-steps (with <code class="docutils literal notranslate"><span class="pre">dt=1e-3</span></code>), controlled by the parameter <code class="docutils literal notranslate"><span class="pre">nts</span></code>. Regarding the interaction potential, the parameter <code class="docutils literal notranslate"><span class="pre">rw</span></code> that controls the well radius must be changed for the different radii <code class="docutils literal notranslate"><span class="pre">rw=0.33,0.34,0.35</span></code> (in <span class="math notranslate nohighlight">\(\sigma\)</span>). The parameter <code class="docutils literal notranslate"><span class="pre">nkT</span></code> (well depth) must change it for each simulation with the corresponding value. Also, the <code class="docutils literal notranslate"><span class="pre">thermoSteps</span></code> should have a reasonable value (1000 is recommended), and <code class="docutils literal notranslate"><span class="pre">dumpSteps</span></code> can be set above 50000 timesteps as the trajectory is not needed for this step</p></li>
<li><p>Launch the simulation for each radius and well depth.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">thermo_style</span></code> is configured to show some magnitudes that are crucial for the thermodynamic integration. We need to get the average number of well occupancy for each value of <code class="docutils literal notranslate"><span class="pre">nkT</span></code> so that we print the potential contribution due to LJ particle-well interaction (<code class="docutils literal notranslate"><span class="pre">c_1</span></code>, column 13), but also the number of particles in the system (<code class="docutils literal notranslate"><span class="pre">v_nall</span></code>, column 15) since the energy is expressed in reduced LJ units, <em>i.e.</em> energy per particle instead of energy of the total system:</p></li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># ------------- Output thermo information and averaged variables ---------------
variable well equal c_1*count(all)
variable nall equal count(all)
compute mytemp melt temp
compute 1 all pair square/well
thermo    ${thermoSteps}
thermo_style  custom step pe epair press ke c_mytemp lx ly lz pxx pyy pzz c_1 v_well v_nall spcpu density
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For real units the multiplication by the number of particles in the system is not necessary.</p>
</div>
<p>The calculation of the well occupancy for each depth can be estimated easily by taking the average over all the simulation of this value:</p>
<div class="math notranslate nohighlight">
\[\langle Nw \rangle=c_1\cdot n_all/(nkT\cdot T)\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that the system requires a time to reach the steady state so that the analysis must be performed discarding after <span class="math notranslate nohighlight">\(t\approx10\tau\)</span>. This equilibration time may vary depending on the system under study (water, hard-spheres, salt…)</p>
</div>
<p>In the following figure the curves of well occupancy vs. well depth for the different radii are presented.</p>
<p><img alt="Step-2\label{Occupancy}" src="_images/Fig3.png" /></p>
</div>
<div class="section" id="extrapolation-and-interfacial-energy-calculation">
<h2>Extrapolation and interfacial energy calculation<a class="headerlink" href="#extrapolation-and-interfacial-energy-calculation" title="Permalink to this headline">¶</a></h2>
<p>After the analysis in the previous step, one obtain a curve of well occupancy vs well depth for each radius so that the interfacial energy is calculated as</p>
<div class="math notranslate nohighlight">
\[\gamma(r_w )=\frac{1}{2l^2 } \left[N_w\cdot\epsilon_{max}-\int_{\epsilon_0}^{\epsilon_{max}}d\epsilon\, N_w(\epsilon) \right],\]</div>
<p>where <span class="math notranslate nohighlight">\(N_w\)</span> is the total number of wells and <span class="math notranslate nohighlight">\(l\)</span> is the short side of the box that can be obtained from the thermo (<code class="docutils literal notranslate"><span class="pre">lx</span></code>, <code class="docutils literal notranslate"><span class="pre">ly</span></code>, columns 7 and 8 int the <code class="docutils literal notranslate"><span class="pre">thermo</span></code>). The resulting integrals are provided in the following table:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-center head"><p><span class="math notranslate nohighlight">\(r_w/\sigma\)</span>)</p></th>
<th class="text-center head"><p>0.33</p></th>
<th class="text-center head"><p>0.34</p></th>
<th class="text-center head"><p>0.35</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><span class="math notranslate nohighlight">\(\gamma/\sigma^{-2}\epsilon\)</span></p></td>
<td class="text-center"><p>0.363</p></td>
<td class="text-center"><p>0.357</p></td>
<td class="text-center"><p>0.348</p></td>
</tr>
</tbody>
</table>
<p>To obtain the interfacial energy, you now shall extrapolate the value of the interfacial energy to the optimal radius (<span class="math notranslate nohighlight">\(r_{0w}=0.32\sigma\)</span>) using a linear fit. According to the interfacial energy provided in the table the interfacial energy is</p>
<div class="math notranslate nohighlight">
\[\gamma=0.370(8) \epsilon\sigma^(−2)\]</div>
<p>This mold integration reported for the same system an interfacial energy of <span class="math notranslate nohighlight">\(\gamma=0.372(8) \epsilon\sigma^(−2)\)</span> extrapolating to an optimal radius of <span class="math notranslate nohighlight">\(r_{0w}=0.315\sigma\)</span> (please see the work by Espinosa <em>et al</em>Espinosa <em>et al.</em><a class="footnote-reference brackets" href="#footcite-espinosa2014mold" id="id2">1</a>). Additionally, another work using the cleaving technique{footcite:t}(<code class="docutils literal notranslate"><span class="pre">davidchack2003direct</span></code>) reported a value of \gamma=0.371(3) \epsilon\sigma^(−2) for the same system.</p>
<div class="docutils container" id="id3">
<dl class="footnote brackets">
<dt class="label" id="footcite-espinosa2014mold"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>JR Espinosa, C Vega, and E Sanz. The mold integration method for the calculation of the crystal-fluid interfacial free energy from simulations. <em>The Journal of chemical physics</em>, 141(13):134709, 2014.</p>
</dd>
</dl>
</div>
<hr class="footnotes docutils" />
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="example_LM_mw.html" class="btn btn-neutral float-right" title="Solid-Vacuum interface of a Lennard-Jones crystal with wells" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="example.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2023, Andres R. Tejedor, Jorge Ramírez, Nicodemo Di Pasquale, and Jorge R. Espinosa

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>